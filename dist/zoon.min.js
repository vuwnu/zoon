let zdata,z={update(a,b){let c=$q("#pageSelect").value;$q(a).setAttribute("src",b+c)},loadPage(a){$q("z-html").setAttribute("src",a)}},zoon={log(a,b,c){console.log(`%c[zoon] %c[${a}] %c%s`,`color:#ab4cef;${"font-size:15px;"}`,`color:${b};${"font-size:15px;"}`,`color:#888;${"font-size:15px;"}`,c)}};const $q=document.querySelector.bind(document),$qa=(a,b=document)=>Array.from(b.querySelectorAll(a));class ZoonData extends HTMLElement{connectedCallback(){let a=this,b=this.innerHTML;b=b.replace(/(\n)+/g,"\", \"").replace(/( = )+/g,"\":\"").slice(0,-3).slice(2),b=`{${b}}`;let c=JSON.parse(b);Object.assign(zdata,c),console.log(c),a.remove()}}class ZoonFrame extends HTMLElement{constructor(){super(),this.setup()}setup(){this.hasAttribute("frame")||this.setAttribute("frame","default"),this.hasAttribute("src")||this.setAttribute("src","/frames/")}render(){let a,b,c;c=$q("body"),this.frame=this.getAttribute("frame"),a=b,fetch(this.getAttribute("src")+this.getAttribute("frame")+".html").catch(()=>{zoon.log("Error fetching layout")}).then(a=>a.text()).then(a=>{this.text=a,c.insertAdjacentHTML("beforeend",this.text)}),zoon.log("z-frame","#de922f",`Frame set to ${this.frame}`)}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}static get observedAttributes(){return["src","frame"]}}class ZoonHTML extends HTMLElement{connectedCallback(){this.setFromSource()}setFromSource(){fetch(this.getAttribute("src")).then(a=>a.text()).then(a=>{this.innerHTML=a})}attributeChangedCallback(){this.hasAttribute("src")?this.setFromSource():this.hasAttribute("key")&&this.setFromURL()}static get observedAttributes(){return["src"]}}class ZoonTitle extends HTMLElement{run(){let a=this.getAttribute("title")||"",b=this.getAttribute("prepend")||"",c=this.getAttribute("append")||"",d=`${b}${a}${c}`;document.title=d,zoon.log("z-title","#2f84de",`title set as ${d}`)}connectedCallback(){this.run()}attributeChangedCallback(){this.run()}static get observedAttributes(){return["title","prepend","append"]}}class ZoonTime extends HTMLElement{render(){let a=new Date(this.getAttribute("datetime")||Date.now());this.innerHTML=new Intl.DateTimeFormat("default",{year:this.getAttribute("year")||void 0,month:this.getAttribute("month")||void 0,day:this.getAttribute("day")||void 0,hour:this.getAttribute("hour")||void 0,minute:this.getAttribute("minute")||void 0,second:this.getAttribute("second")||void 0,timeZoneName:this.getAttribute("time-zone-name")||void 0}).format(a)}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}static get observedAttributes(){return["datetime","year","month","day","hour","minute","second","time-zone-name"]}attributeChangedCallback(){this.render()}}class ZoonClock extends HTMLElement{render(){this.innerHTML=`
    <z-time hour="numeric" minute="numeric" second="numeric">
    </z-time>
    `,this.timerElem=this.firstElementChild}connectedCallback(){this.rendered||(this.render(),this.rendered=!0),this.timer=setInterval(()=>this.update(),1e3)}update(){this.date=new Date,this.timerElem.setAttribute("datetime",this.date),this.dispatchEvent(new CustomEvent("tick",{detail:this.date}))}disconnectedCallback(){clearInterval(this.timer)}}class ZoonVariable extends HTMLElement{render(){this.getAttribute("object");this.innerHTML=zdata[this.getAttribute("var")]||""}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}}class ZoonNavbar extends HTMLElement{connectedCallback(){this.setCurrentPage()}setCurrentPage(){let a=location.pathname;if("/"!==a){let b=this.getElementsByTagName("a");for(let c=0,d=b.length;c<d;c++)-1!==b[c].getAttribute("href").indexOf(a)&&b[c].classList.add("current-page")}}setupLinks(){let a=this.getElementsByTagName("a");for(let b=0,c=a.length;b<c;b++)-1!==a[b].getAttribute("href").indexOf(current_location)&&(a[b].className="current-page")}}class ZoonLogo extends HTMLElement{connectedCallback(){this.getAttribute("tag");this.innerHTML=`<a href="https://zoon.vuw.nu">Zoon</a>`}}class ZoonHTMLQuery extends HTMLElement{connectedCallback(){const a=new URLSearchParams(window.location.search),b=this.getAttribute("src"),c=this.getAttribute("key"),d=a.get(c);let e;null!==d&&(e=b+d+".html",fetch(e).then(a=>a.text()).then(a=>{this.innerHTML=a}),zoon.log("z-page","#2fde45",`query is ${d}`))}}class ZoonHTMLPath extends HTMLElement{render(){const a=new URLSearchParams(window.location.search),b=window.location.pathname,c=this.getAttribute("src");let d;d="/"===b?c+"/home.html":c+b+".html",fetch(d).then(a=>a.text()).then(a=>{this.innerHTML=a}),zoon.log("z-page","#2fde45",`page is ${b}`)}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}}class ZoonInsert extends HTMLElement{connectedCallback(){const a=$q("z-insert"),b=$q(this.getAttribute("input"));for(;0<b.childNodes.length;)a.appendChild(b.childNodes[0]);b.remove()}}class ZoonTable extends HTMLElement{render(){let a=window[this.getAttribute("src")],b=Object.keys(a[0]),c=b.map(a=>`<th>${a}</th>`).join(""),d=a.map(a=>{let c=b.map(b=>`<td>${a[b]}</td>`).join("");return`<tr>${c}</tr>`}).join("");this.innerHTML=`
    <table>
      <thead>
        <tr>${c}</tr>
      <thead>
      <tbody>
        ${d}
      <tbody>
    <table>`,zoon.log("z-table","#2fc4de",`Built table`)}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}attributeChangedCallback(){this.render()}static get observedAttributes(){return["src"]}}class ZoonTemplate extends HTMLElement{render(){let a=$q("#"+this.getAttribute("src"));this.attachShadow({mode:"open"}).append(a.content.cloneNode(!0))}connectedCallback(){this.rendered||(this.render(),this.rendered=!0)}}class ZoonCards extends HTMLElement{connectedCallback(){let a=$q("#"+this.getAttribute("tmpl"));this.attachShadow({mode:"open"}).append(a.content.cloneNode(!0));let b=this.getAttribute("json");fetch(b).then(a=>a.json()).then(a=>window[this.getAttribute("name")]=a).catch(console.error)}}class ZoonLightswitch extends HTMLElement{connectedCallback(){const a=this.getAttribute("on"),b=this.getAttribute("off");this.init(),this.addEventListener("click",function(){this.toggle()},!1)}init(){const a=$q("#"+this.getAttribute("target"));window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?a.classList.add(`lightswitch-off`):a.classList.add(`lightswitch-on`)}toggle(){const a=$q("#"+this.getAttribute("target"));a.classList.contains(`lightswitch-off`)?this.turnOn():this.turnOff()}turnOn(){const a=$q("#"+this.getAttribute("target"));a.classList.replace(`lightswitch-off`,`lightswitch-on`)}turnOff(){const a=$q("#"+this.getAttribute("target"));a.classList.replace(`lightswitch-on`,`lightswitch-off`)}}class ZoonObject extends HTMLElement{connectedCallback(){this.setupObject()}setupObject(){const a=this.getAttribute("name"),b=this.getAttribute("src");fetch(b).then(a=>a.json()).then(a=>window[this.getAttribute("name")]=a).catch(console.error),zoon.log("z-object","#de2f7d",`Created an object with the name ${a}`)}}class ZoonButton extends HTMLElement{setup(){this.actiom=this.getAttribute("action"),this.target=this.getAttribute("target"),this.addEventListener("click",function(){this.run()},!1)}run(){console.log("button pressed");$q(this.target)}connectedCallback(){this.rendered||(this.setup(),this.rendered=!0)}update(){this.actiom=this.getAttribute("action"),this.target=this.getAttribute("target")}attributeChangedCallback(){this.update()}static get observedAttributes(){return["action","target"]}}class ZoonSpeech extends HTMLElement{run(){let a=new SpeechSynthesisUtterance(this.text),b=window.speechSynthesis.getVoices();a.voice=b[0],a.pitch=this.pitch,a.rate=this.rate,window.speechSynthesis.speak(a)}update(){this.text=this.getAttribute("input"),this.voice=this.getAttribute("voice"),this.pitch=this.getAttribute("pitch"),this.rate=this.getAttribute("rate")}connectedCallback(){this.update()}attributeChangedCallback(){this.update()}static get observedAttributes(){return["input","voice","pitch","rate"]}}function defineElements(){customElements.define("zoon-logo",ZoonLogo),customElements.define("z-title",ZoonTitle),customElements.define("z-frame",ZoonFrame),customElements.define("z-speech",ZoonSpeech),customElements.define("z-data",ZoonData),customElements.define("z-object",ZoonObject),customElements.define("z-time",ZoonTime),customElements.define("z-clock",ZoonClock),customElements.define("z-nav",ZoonNavbar),customElements.define("z-insert",ZoonInsert),customElements.define("z-html",ZoonHTML),customElements.define("z-html-query",ZoonHTMLQuery),customElements.define("z-html-path",ZoonHTMLPath),customElements.define("z-template",ZoonTemplate),customElements.define("z-cards",ZoonCards),customElements.define("z-table",ZoonTable),customElements.define("z-lightswitch",ZoonLightswitch),setTimeout(()=>{customElements.define("z-var",ZoonVariable)},100)}(function(a){if(a.search){var b={};a.search.slice(1).split("&").forEach(function(c){var d=c.split("=");b[d[0]]=d.slice(1).join("=").replace(/~and~/g,"&")}),b.p!==void 0&&window.history.replaceState(null,null,a.pathname.slice(0,-1)+(b.p||"")+(b.q?"?"+b.q:"")+a.hash)}})(window.location),function(){const a=document.createElement("link");a.href="https://cdn.jsdelivr.net/gh/vuwnu/zoon@master/dist/zoon.min.css",a.rel="stylesheet",document.head.append(a),fetch("/zdata.json").then(a=>a.json()).then(a=>zdata=a).catch(console.error)}(),window.addEventListener("load",()=>{setTimeout(()=>{defineElements()},100)});